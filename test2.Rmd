---
title: "Busch League Reference"
output: 
  flexdashboard::flex_dashboard:
    logo: blf_logo_icon.png
    orientation: columns
    vertical_layout: scroll
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(knitr)
library(kableExtra)

ggl_sheet <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vRPAR9n5KuCw3Mw_Ka48khDgK28rrnD4XujJ_tAadcA_kmbYjZF6ZFKX-7WGRHBlY47N8jP6G8JgG1k/pub?gid=0&single=true&output=csv"

games_raw <- read_csv(ggl_sheet)

games_raw$Team <- toupper(games_raw$Team)

games_raw <- games_raw %>%
  mutate_all(~replace(., is.na(.), 0))

games_raw$Team <- as.factor(games_raw$Team)

write_csv(games_raw, "gamessource.csv")

this_year <- max(games_raw$Year)

games_ty <- games_raw %>%
  filter(Year == this_year) %>%
  arrange(desc(Week))

games_allplay <- games_raw %>%
  group_by(Week, Year) %>%
  mutate(w_rank = ifelse(Year == 2008, rank(PF) / 4 + 1, rank(PF))) %>%
  mutate(APW = as.integer(w_rank - 1)) %>%
  mutate(l_rank = ifelse(Year == 2008, rank(-PF) / 4 + 1, rank(-PF))) %>%
  mutate(APL = as.integer(l_rank - 1)) %>%
  select(-w_rank, -l_rank)

this_week <- games_ty[[1, 2]]

ty_ppg <- mean(games_raw$PF)

games_adj <- games_raw %>%
  group_by(Year) %>%
  mutate(ppg = mean(PF)) %>%
  ungroup() %>%
  mutate(Adj_PF = PF / ppg * ty_ppg) %>%
  select(-ppg)

team01 <- "ADAM HARTMAN"
team02 <- "DAVID PIKUS"
team03 <- "DERRIK HARTMAN"
team04 <- "DREW VOGT"
team05 <- "JOHN THOMPSON"
team06 <- "MATT TRAEN"
team07 <- "MAX APONTE"
team08 <- "PHIL BASTRON"
team09 <- "TIM GREVE"
team10 <- "TIM LANG"
team11 <- "TODD TRAEN"
team12 <- "TREVOR SOUPIR"

get_founded <- function(teamid) {
  games_raw %>% 
  filter(Team == teamid) %>% 
  filter(Year == min(Year)) %>% 
  filter(Week == 1) %>% 
  pull(Year)
}

get_buschbowls <- function(teamid) {
  games_raw %>% 
  filter(Team == teamid) %>% 
  filter(Type == "Championship") %>% 
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  summarise(champs = sum(w_l)) %>%
  pull(champs)
}

get_po_appear <- function(teamid) {
  games_raw %>% 
  filter(Team == teamid) %>% 
  filter(Type == "Playoffs") %>%
  group_by(Year) %>%
  summarize(mean(PF)) %>%
  nrow()
}

get_winning_seasons <- function(teamid) {
  games_raw %>% 
  filter(Team == teamid) %>% 
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Year) %>%
  summarise(Win = sum(w_l), Loss = sum(w_l == 0), 
            Pct = as.double(Win / (Win + Loss))) %>%
  mutate(over500 = as.numeric(as.logical(Pct > .5))) %>%
  summarise(winning_seasons = sum(over500)) %>%
  pull(winning_seasons)
}

at_wpct_max <- games_raw %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Win = sum(w_l), Loss = sum(w_l == 0), Pct = as.integer(Win / (Win + Loss) * 1000)) %>%
  arrange(desc(Pct)) %>%
  head(1) %>%
  pull(Pct)

at_wpct_min <- games_raw %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Win = sum(w_l), Loss = sum(w_l == 0), Pct = as.integer(Win / (Win + Loss) * 1000)) %>%
  arrange(Pct) %>%
  head(1) %>%
  pull(Pct)

at_ppg_max <- games_adj %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  group_by(Team) %>%
  summarise(PPG = mean(Adj_PF)) %>%
  arrange(desc(PPG)) %>%
  head(1) %>%
  pull(PPG) %>%
  as.integer()

at_ppg_min <- games_adj %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  group_by(Team) %>%
  summarise(PPG = mean(Adj_PF)) %>%
  arrange(PPG) %>%
  head(1) %>%
  pull(PPG) %>%
  as.integer()

y12t_wpct_max <- games_raw %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  filter(Year > 2012) %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Win = sum(w_l), Loss = sum(w_l == 0), Pct = as.integer(Win / (Win + Loss) * 1000)) %>%
  arrange(desc(Pct)) %>%
  head(1) %>%
  pull(Pct) %>%
  as.integer()

y12t_wpct_min <- games_raw %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  filter(Year > 2012) %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Win = sum(w_l), Loss = sum(w_l == 0), Pct = as.integer(Win / (Win + Loss) * 1000)) %>%
  arrange(Pct) %>%
  head(1) %>%
  pull(Pct) %>%
  as.integer()

y12t_ppg_max <- games_adj %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  filter(Year > 2012) %>%
  group_by(Team) %>%
  summarise(PPG = mean(Adj_PF)) %>%
  arrange(desc(PPG)) %>%
  head(1) %>%
  pull(PPG) %>%
  as.integer()

y12t_ppg_min <- games_adj %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  filter(Year > 2012) %>%
  group_by(Team) %>%
  summarise(PPG = mean(Adj_PF)) %>%
  arrange(PPG) %>%
  head(1) %>%
  pull(PPG) %>%
  as.integer()

get_at_wpct <- function(teamid) {
  games_raw %>%
  filter(Team == teamid) %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  summarise(Win = sum(w_l), Loss = sum(w_l == 0), Pct = as.integer(Win / (Win + Loss) * 1000)) %>%
  pull(Pct)
}

get_at_ppg <- function(teamid) {
  games_adj %>%
  filter(Team == teamid) %>%
  summarise(PPG = mean(Adj_PF)) %>%
  pull(PPG) %>%
  as.integer()
}

get_12t_wpct <- function(teamid) {
  games_raw %>%
  filter(Team == teamid) %>%
  filter(Year > 2012) %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  summarise(Win = sum(w_l), Loss = sum(w_l == 0), Pct = as.integer(Win / (Win + Loss) * 1000)) %>%
  pull(Pct)
}

get_12t_ppg <- function(teamid) {
  games_adj %>%
  filter(Team == teamid) %>%
  filter(Year > 2012) %>%
  summarise(PPG = mean(Adj_PF)) %>%
  pull(PPG) %>%
  as.integer()
}

get_alltime_stats <- function(teamid) {
  Reg_season <- games_adj %>%
  filter(Type == "Reg") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)


Playoffs <- games_adj %>%
  filter(Type == "Playoffs") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)


BuschBowls <- games_adj %>%
  filter(Type == "Championship") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)

All_Play <- games_allplay %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(APW = sum(APW), 
            APL = sum(APL), 
            Pct = as.integer(APW / (APW + APL) * 1000)) %>%
  filter(Team == teamid)


Reg_season %>%
  inner_join(Playoffs, by = "Team") %>%
  inner_join(BuschBowls, by = "Team") %>%
  inner_join(All_Play, by = "Team") %>%
  rename(R.W = W.x,
         R.L = L.x,
         "R.%" = Pct.x,
         R.PPG = PPG.x,
         PO.W = W.y,
         PO.L = L.y,
         "PO.%" = Pct.y,
         PO.PPG = PPG.y,
         BB.W = W,
         BB.L = L,
         BB.Pct = Pct.x.x,
         BB.PPG = PPG,
         "APW%" = Pct.y.y) %>%
  kable() %>%
  kable_styling() %>%
  add_header_above(c(" ", "Regular Season" = 4, "Playoffs" = 4, "Busch Bowls" = 4, "All Play" = 3))
}


get_12t_stats <- function(teamid) {
  Reg_season <- games_adj %>%
  filter(Year > 2012) %>%
  filter(Type == "Reg") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)


Playoffs <- games_adj %>%
  filter(Year > 2012) %>%
  filter(Type == "Playoffs") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)


BuschBowls <- games_adj %>%
  filter(Year > 2012) %>%
  filter(Type == "Championship") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)


All_Play <- games_allplay %>%
  filter(Team == teamid) %>%
  filter(Year > 2012) %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Team, .drop = FALSE) %>%
  summarise(APW = sum(APW), 
            APL = sum(APL), 
            Pct = as.integer(APW / (APW + APL) * 1000))

Reg_season %>%
  inner_join(Playoffs, by = "Team") %>%
  inner_join(BuschBowls, by = "Team") %>%
  inner_join(All_Play, by = "Team") %>%
  rename(R.W = W.x,
         R.L = L.x,
         "R.%" = Pct.x,
         R.PPG = PPG.x,
         PO.W = W.y,
         PO.L = L.y,
         "PO.%" = Pct.y,
         PO.PPG = PPG.y,
         BB.W = W,
         BB.L = L,
         BB.Pct = Pct.x.x,
         BB.PPG = PPG,
         "APW%" = Pct.y.y) %>%
  kable() %>%
  kable_styling() %>%
  add_header_above(c(" ", "Regular Season" = 4, "Playoffs" = 4, "Busch Bowls" = 4, "All Play" = 3))
}


get_season_summary <- function(teamid) {
  Reg_season <- games_adj %>%
  filter(Type == "Reg") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Year, Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)


Playoffs <- games_adj %>%
  filter(Type == "Playoffs") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Year, Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)


BuschBowls <- games_adj %>%
  filter(Type == "Championship") %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Year, Team, .drop = FALSE) %>%
  summarise(W = sum(w_l), 
            L = sum(w_l == 0), 
            Pct = as.integer(W / (W + L) * 1000), 
            PPG = mean(Adj_PF)) %>%
  filter(Team == teamid)

All_Play <- games_allplay %>%
  mutate(w_l = as.numeric(PF > PA)) %>%
  group_by(Year, Team, .drop = FALSE) %>%
  summarise(APW = sum(APW), 
            APL = sum(APL), 
            Pct = as.integer(APW / (APW + APL) * 1000)) %>%
  filter(Team == teamid)


Reg_season %>%
  inner_join(Playoffs, by = c("Year", "Team")) %>%
  inner_join(BuschBowls, by = c("Year", "Team")) %>%
  inner_join(All_Play, by = c("Year", "Team")) %>%
  rename(R.W = W.x,
         R.L = L.x,
         "R.%" = Pct.x,
         R.PPG = PPG.x,
         PO.W = W.y,
         PO.L = L.y,
         "PO.%" = Pct.y,
         PO.PPG = PPG.y,
         BB.W = W,
         BB.L = L,
         BB.Pct = Pct.x.x,
         BB.PPG = PPG,
         "APW%" = Pct.y.y) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>%
  add_header_above(c(" " = 2, "Regular Season" = 4, "Playoffs" = 4, "Busch Bowls" = 4, "All Play" = 3))
}


get_game_log <- function(teamid) {
  games_adj %>%
  filter(Team == teamid) %>%
  mutate("W/L" = as.numeric(PF > PA)) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE, position = "left")
}

```


HOME
=====================================

### Rankings
Test

### What's Happening?
Test


NFL PLAYERS
===================================== 

Column {.tabset}
---

### WAR Stats
Test - shiny for viewing by position

### Draft History
Test - shiny for year?


`r team01` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 

Row {data-height=30}
-------------------------------------
**`r team01`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team01)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team01)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team01)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team01)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------

### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team01)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team01)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team01)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team01)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team01)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team01)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team01)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team01)
```



`r team02` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team02`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team02)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team02)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team02)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team02)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team02)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team02)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team02)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team02)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------
### All Time

```{r}
get_alltime_stats(team02)
```

Row
-------------------------------------
### 12 Team Era

```{r}
get_12t_stats(team02)
```


Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team02)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team02)
```



`r team03` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team03`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team03)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team03)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team03)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team03)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team03)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team03)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team03)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team03)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team03)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team03)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team03)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team03)
```



`r team04` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team04`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team04)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team04)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team04)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team04)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team04)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team04)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team04)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team04)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team04)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team04)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team04)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team04)
```



`r team05` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team05`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team05)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team05)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team05)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team05)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team05)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team05)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team05)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team05)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team05)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team05)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team05)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team05)
```



`r team06` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team06`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team06)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team06)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team06)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team06)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team06)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team06)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team06)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team06)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team06)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team06)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team06)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team06)
```



`r team07` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team07`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team07)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team07)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team07)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team07)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team07)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team07)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team07)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team07)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team07)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team07)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team07)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team07)
```



`r team08` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team08`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team08)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team08)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team08)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team08)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team08)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team08)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team08)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team08)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team08)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team08)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team08)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team08)
```



`r team09` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team09`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team09)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team09)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team09)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team09)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team09)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team09)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team09)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team09)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team09)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team09)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team09)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team09)
```



`r team10` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team10`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team10)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team10)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team10)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team10)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team10)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team10)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team10)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team10)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team10)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team10)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team10)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team10)
```



`r team11` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team11`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team11)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team11)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team11)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team11)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team11)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team11)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team11)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team11)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team11)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team11)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team11)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team11)
```



`r team12` {data-navmenu="FRANCHISES" data-orientation=rows}
===================================== 
Row {data-height=30}
-------------------------------------
**`r team12`**

Row
-------------------------------------

### Founded
```{r}
founded <- get_founded(team12)
valueBox(founded, icon = "fa-calendar-plus")
```

### Busch Bowls
```{r}
champs <- get_buschbowls(team12)
valueBox(champs, icon = "fa-trophy")
```

### Playoff Appearances
```{r}
playoff_appear <- get_po_appear(team12)
valueBox(playoff_appear, icon = "fa-award")
```

### Winning Seasons
```{r}
winning_seasons <- get_winning_seasons(team12)
valueBox(winning_seasons, icon = "fa-star-half-alt")
```

Row
-------------------------------------
### All Time Win Percentage

```{r}
wpct <- get_at_wpct(team12)
gauge(wpct, min = at_wpct_min, max = at_wpct_max)
```

### All Time PPG (Adjusted)

```{r}
ppg <- get_at_ppg(team12)
gauge(ppg, min = at_ppg_min, max = at_ppg_max)
```

### 12T Era Win Percentage

```{r}
wpct <- get_12t_wpct(team12)
gauge(wpct, min = y12t_wpct_min, max = y12t_wpct_max)
```

### 12T Era PPG (Adjusted)

```{r}
ppg <- get_12t_ppg(team12)
gauge(ppg, min = y12t_ppg_min, max = y12t_ppg_max)
```

Row {data-height=30}
-------------------------------------
*R = Regular Season, PO = Playoffs, BB = Busch Bowl, AP = All Play*

Row
-------------------------------------

### All Time

```{r}
get_alltime_stats(team12)
```

Row
-------------------------------------

### 12 Team Era

```{r}
get_12t_stats(team12)
```

Row
-------------------------------------

### Season Summary

```{r}
get_season_summary(team12)
```

Row
-------------------------------------

### Game Log

```{r}
get_game_log(team12)
```



SEASONS
===================================== 

### Champion/Runner up
Test

### Power Rank
Test

### Standings
Test


ALL TIME {data-navmenu="RECORDS" data-orientation=rows}
===================================== 

Row
-------------------------------------

### Career

```{r}
at_wins <- games_raw %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Record = "Most Wins", 
            n = sum(w_l), 
            Loss = sum(w_l == 0), 
            Pct = as.integer(n / (n + Loss) * 1000)) %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)

at_w_pct <- games_raw %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Record = "Highest W%", 
            Win = sum(w_l), 
            Loss = sum(w_l == 0), 
            n = as.integer(Win / (Win + Loss) * 1000)) %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)

at_po_appear <- games_raw %>%
  select(Year, Team, Type) %>%
  filter(Type == "Playoffs") %>%
  distinct() %>%
  count(Team) %>%
  filter(n > 1) %>%
  mutate(Record = "Playoff Appearances") %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)

at_playoff_w <- games_raw %>%
  filter(Type == "Playoffs" | Type == "Championship") %>%
  group_by(Team) %>%
  filter(n() > 2) %>%
  ungroup() %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Record = "Playoff Wins", 
            n = sum(w_l), 
            Loss = sum(w_l == 0), 
            Pct = as.integer(n / (n + Loss) * 1000)) %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)  

at_bb_appear <- games_raw %>%
  select(Year, Team, Type) %>%
  filter(Type == "Championship") %>%
  distinct() %>%
  count(Team) %>%
  filter(n > 1) %>%
  mutate(Record = "Busch Bowl Appearances") %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)

at_bb_w <- games_raw %>%
  filter(Type == "Championship") %>%
  group_by(Team) %>%
  filter(n() > 2) %>%
  ungroup() %>%
  mutate(w_l = as.numeric(as.logical(PF > PA))) %>%
  group_by(Team) %>%
  summarise(Record = "Busch Bowl Wins", 
            n = sum(w_l), 
            Loss = sum(w_l == 0), 
            Pct = as.integer(n / (n + Loss) * 1000)) %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team) 

at_apw <- games_allplay %>%
  filter(Type == "Reg") %>%
  group_by(Team) %>%
  summarise(Record = "All Play Wins", 
            n = as.integer(sum(APW)), 
            APL = as.integer(sum(APL))) %>%
  mutate(Pct = as.integer(n / (n + APL) * 1000)) %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)

at_apw_pct <- games_allplay %>%
  filter(Type == "Reg") %>%
  group_by(Team) %>%
  summarise(Record = "All Play W%%", 
            APW = as.integer(sum(APW)), 
            APL = as.integer(sum(APL))) %>%
  filter(APW > 150) %>%
  mutate(n = as.integer(APW / (APW + APL) * 1000)) %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)

at_ppg <- games_adj %>%
  group_by(Team) %>%
  filter(n() > 23) %>%
  ungroup() %>%
  group_by(Team) %>%
  summarise(Record = "Points per Game", 
            n = as.integer(mean(Adj_PF))) %>%
  arrange(desc(n)) %>%
  head(1) %>%
  select(Record, n, Team)

rbind(at_wins, at_w_pct, at_po_appear, at_playoff_w, at_bb_appear, at_bb_w, at_apw, at_apw_pct, at_ppg) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE, position = "left")

```

### Season
single season records here

### Game
single game records here. 

Row
-------------------------------------

**Career**
Wins
Win %
playoff appearances
playoff wins
busch bowls
all play wins
all play win%
PPG

**SEASON**
Wins
All Play record
PPG
Least APW
Least PPG

**GAME**
Points
Least points

Row
-------------------------------------

### Records
some sort of navigation? Links separated by | ? three lines (career, season, game)

Team record books?

12 TEAM ERA {data-navmenu="RECORDS" data-orientation=rows}
===================================== 

### Leaderboard
tabs or pages? for all time and 12t era. separate columned tables for career, season, and game records.

record discription, record, Team, When 

### Records
some sort of navigation? Links separated by | ? three lines (career, season, game)


NEWS & TALK
===================================== 

### twitter feed
Test

### slack feed
Test

### Talking Busch feed
Test
